---
title: "Basic Queries"
output: 
    html_document:
      df_print: paged
      theme: 
          bootswatch : readable
---

### Libraries

```{r}
library(RMySQL)
library(bslib)
```


```{r, echo=FALSE}
df <- dbConnect(MySQL(), user="root", host="localhost",
                password="Med_2018france", dbname="soccer")
```

###### 1. From the following table : stade, write a SQL query to count the number of venues for EURO cup 2016. Return number of venues.

```{r}
dbGetQuery(df, "SELECT count(venue_name) as 'number of venue'
                FROM stade")
```

###### 2. From the following table : player_mast, write a SQL query to count the number of countries that participated in the 2016-EURO Cup

```{r}
dbGetQuery(df, "SELECT count(distinct(team_id)) as 'number of countries'
                FROM player_mast")
```

###### 3. From the following table : goal_details, write a SQL query to find the number of goals scored within normal play during the EURO cup 2016

```{r}
dbGetQuery(df, "SELECT count(goal_id) as 'goals scored within normal play'
                FROM goal_details")
```
###### 4. From the following table : match_mast, write a SQL query to find the number of matches that ended with a result.

```{r}
dbGetQuery(df, "SELECT count(results) as 'matches'
                FROM match_mast
                WHERE results = 'WIN'")
```


###### 5. From the following table : match_mast, write a SQL query to find the number of matches that ended in draws.

```{r}
dbGetQuery(df, "SELECT count(results) as 'matches end in draws'
                FROM match_mast
                WHERE results = 'DRAW'")
```


###### 6. From the following table : match_mast, write a SQL query to find out when the Football EURO cup 2016 will begin.

```{r}
dbGetQuery(df, "SELECT play_date as 'begin date'
                FROM match_mast
                WHERE match_no = 1")
```

###### 7. From the following table : goal_details, write a SQL query to find the number of self-goals scored during the 2016 European Championship.

```{r}
dbGetQuery(df, "SELECT count(*) as 'self-goals scored'
                FROM goal_details
                WHERE goal_type = 'O'")
```


###### 8. From the following table : match_mast, write a SQL query to count the number of matches ended with a win results in-group stage.

```{r}
dbGetQuery(df, "SELECT count(*) as 'win matches'
                FROM match_mast
                WHERE play_stage = 'G' AND results = 'WIN'")
```


###### 9. From the following table : penalty_shootout, write a SQL query to find the number of matches that resulted in a penalty shootout

```{r}
dbGetQuery(df, "SELECT count(distinct(match_no)) as 'matches that resulted in a penalty shootout'
                FROM penalty_shootout")
```


###### 10. From the following table : match_mast, write a SQL query to find number of matches decided by penalties in the Round 16.

```{r}
dbGetQuery(df, "SELECT count(distinct(match_no)) as 'matches decided by penalties in the Round 16'
                FROM match_mast
                WHERE play_stage = 'R' AND decided_by = 'P'")
```


###### 11. From the following table :  goal_details, write a SQL query to find the number of goals scored in every match within a normal play schedule. Sort the result-set on match number. Return match number, number of goal scored.

```{r}
dbGetQuery(df, "SELECT match_no, 
                       count(goal_id) as 'number of goal scored'
                FROM goal_details
                GROUP BY match_no
                ORDER BY match_no")
```

###### 12. From the following table : match_mast, write a SQL query to find the matches in which no stoppage time was added during the first half of play. Return match no, date of play, and goal scored.

```{r}
dbGetQuery(df, "SELECT match_no,
                       play_date,
                       goal_score
                FROM match_mast
                WHERE stop1_sec = 0")
```


###### 13. From the following table : match_details, write a SQL query to count the number of matches that ended in a goalless draw at the group stage. Return number of matches. 

```{r}
dbGetQuery(df, "SELECT count(distinct(match_no)) as 'number of matches that ended in a goalless draw' 
                FROM match_details
                WHERE play_stage = 'G' AND win_lose = 'D' AND goal_score = 0")
```


###### 14. From the following table : match_details, write a SQL query to calculate the number of matches that ended in a single goal win, excluding matches decided by penalty shootouts. Return number of matches.

```{r}
dbGetQuery(df, "SELECT count(distinct(match_no)) as 'number of matches that ended in a single goal win' 
                FROM match_details
                WHERE win_lose = 'W' AND goal_score = 1 AND decided_by != 'P'")
```

###### 15. From the following table : player_in_out, write a SQL query to count the number of players replaced in the tournament. Return number of players as "Player Replaced".

```{r}
dbGetQuery(df, "SELECt count(player_id) as 'Player Replaced'
                FROM player_in_out
                WHERE in_out = 'I'")
```


###### 16. From the following table : player_in_out, write a SQL query to count the total number of players replaced during normal playtime. Return number of players as "Player Replaced".

```{r}
dbGetQuery(df, "SELECt  count(player_id) as 'Player Replaced'
                FROM player_in_out
                WHERE in_out ='I' AND play_schedule = 'NT'")
```

###### 17. From the following table  : player_in_out, write a SQL query to count the number of players who were replaced during the stoppage time. Return number of players as "Player Replaced".

```{r}
dbGetQuery(df, "SELECt  count(player_id) as 'Player Replaced'
                FROM player_in_out
                WHERE in_out ='I' AND play_schedule = 'ST'")
```

###### 18. From the following table : player_in_out, write a SQL query to count the number of players who were replaced during the first half. Return number of players as "Player Replaced".

```{r}
dbGetQuery(df, "SELECt  count(player_id) as 'Player Replaced'
                FROM player_in_out
                WHERE in_out ='I' AND play_schedule='NT' AND play_half = '1'")
```

###### 19. From the following table : match_details, write a SQL query to count the total number of goalless draws played in the entire tournament. Return number of goalless draws

```{r}
dbGetQuery(df, "SELECT count(distinct(match_no)) as 'number of matches that ended in a goalless draw in the entire tournament' 
                FROM match_details
                WHERE win_lose = 'D' AND goal_score = 0")
```

###### 20. From the following table : player_in_out, write a SQL query to calculate the total number of players who were replaced during the extra time.

```{r}
dbGetQuery(df, "SELECt  count(player_id) as 'Player Replaced'
                FROM player_in_out
                WHERE in_out='I' AND play_schedule='ET'")
```

###### 21. From the following table : player_in_out, write a SQL query to count the number of substitutes during various stages of the tournament. Sort the result-set in ascending order by play-half, play-schedule and number of substitute happened. Return play-half, play-schedule, number of substitute happened.

```{r}
dbGetQuery(df, "SELECT count(*),play_half, play_schedule
                FROM player_in_out
                WHERE in_out ='I'
                GROUP BY play_half, play_schedule
                ORDER BY play_half, play_schedule, count(*) DESC")
```


###### 22. From the following table : penalty_shootout, write a SQL query to count the number of shots taken in penalty shootouts matches. Number of shots as "Number of Penalty Kicks".

```{r}
dbGetQuery(df, "SELECT count(*) as 'Number of Penalty Kicks', match_no
                FROM penalty_shootout
                GROUP BY match_no")
```

###### 23. From the following table : penalty_shootout, write a SQL query to count the number of shots that were scored in penalty shootouts matches. Return number of shots scored goal as "Goal Scored by Penalty Kicks".

```{r}
dbGetQuery(df, "SELECT count(*) as 'Goal Scored by Penalty Kicks'
                FROM penalty_shootout
                WHERE score_goal = 'Y'")
```



###### 24. From the following table : penalty_shootout, write a SQL query to count the number of shots missed or saved in penalty shootout matches. Return number of shots missed as "Goal missed or saved by Penalty Kicks". 

```{r}
dbGetQuery(df, "SELECT count(*) as 'Goal missed or saved by Penalty Kicks'
                FROM penalty_shootout
                WHERE score_goal = 'N'")
```


###### 25. From the following table : player_booked, write a SQL query to count the number of bookings in each half of play within the normal play schedule. Return play_half, play_schedule, number of booking happened.

```{r}
dbGetQuery(df, "SELECT count(*), play_half
                FROM player_booked
                WHERE play_schedule = 'NT'
                GROUP BY play_half")
```



###### 26. From the following table : player_booked, write a SQL query to count the number of bookings during stoppage time. 

```{r}
dbGetQuery(df, "SELECT count(*) as 'number of bookings during stoppage time'
                FROM player_booked
                WHERE play_schedule = 'ST'")
```



###### 27. From the following table : player_booked, write a SQL query to count the number of bookings that happened in extra time.

```{r}
dbGetQuery(df, "SELECT count(*) as 'number of bookings during extra time'
                FROM player_booked
                WHERE play_schedule = 'ET'")
```








